{
    "version": "https://jsonfeed.org/version/1",
    "title": "PyQt • All posts by \"滑动条\" tag",
    "description": "Python PyQt PyQt6 PyQt5 PyQt4 PySide PySide2 PySide6",
    "home_page_url": "https://pyqt5.com",
    "items": [
        {
            "id": "https://pyqt5.com/jumpslider.html",
            "url": "https://pyqt5.com/jumpslider.html",
            "title": "PyQt5之QSlider滑动条点击定位",
            "date_published": "2018-11-05T15:12:26.000Z",
            "content_html": "<p><code>QSlider</code>  在通常情况下支持鼠标点击可以任意拖动，或者鼠标点击则往鼠标点击的方向移动一小格，这种移动一小格通常情况下用起来很不方便，比如我要做一个播放器的播放进度条，肯定是点击某个位置就直接跳到该位置，为此需要对  <code>QSlider</code>  的鼠标事件 <code>mousePressEvent</code>  进行重写。</p>\n<span id=\"more\"></span>\n<h2 id=\"实现方法\"><a class=\"markdownIt-Anchor\" href=\"#实现方法\">#</a> 实现方法</h2>\n<p>一般的想法就是重写 <code>mousePressEvent</code>  后，得到鼠标点击的 x 和 y 点然后进行比例换算，再通过 <code>setValue</code>  来设置值，其实 <code>QSlider</code>  的 <code>style</code>  里面是有一个 <code>sliderValueFromPosition</code>  方法来计算值的。直接调用这个方法即可。</p>\n<ol>\n<li>首先通过 <code>QSlider.style().subControlRect</code>  方法计算得到滑块的区域，当鼠标点击区域在此次时则交给系统自己处理（比如按住不放拖动）</li>\n<li>通过 <code>orientation</code>  判断滑动条的方向（横竖）</li>\n<li>通过 <code>invertedAppearance</code>  判断滑动条是否反向（左右、上下）</li>\n<li>通过 <code>QSlider.style().sliderValueFromPosition(最小值, 最大值, x或者y坐标, 宽度或者高度)</code>  来计算得到值</li>\n<li>最后通过 <code>setValue</code>  来设置值</li>\n</ol>\n<h2 id=\"代码\"><a class=\"markdownIt-Anchor\" href=\"#代码\">#</a> 代码</h2>\n<p><a href=\"https://github.com/PyQt5/PyQt/blob/master/QSlider/ClickJumpSlider.py\">https://github.com/PyQt5/PyQt/blob/master/QSlider/ClickJumpSlider.py</a></p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"token triple-quoted-string string\">\"\"\"\nCreated on 2018年11月5日\n@author: Irony\n@site: https://pyqt5.com https://github.com/892768447\n@email: 892768447@qq.com\n@file: JumpSlider\n@description: \n\"\"\"</span>\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtCore <span class=\"token keyword\">import</span> Qt\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtWidgets <span class=\"token keyword\">import</span> QSlider<span class=\"token punctuation\">,</span> QStyleOptionSlider<span class=\"token punctuation\">,</span> QStyle<span class=\"token punctuation\">,</span> QWidget<span class=\"token punctuation\">,</span>\\\n    QFormLayout<span class=\"token punctuation\">,</span> QLabel\n\n\n__Author__ <span class=\"token operator\">=</span> <span class=\"token triple-quoted-string string\">\"\"\"By: Irony\nQQ: 892768447\nEmail: 892768447@qq.com\"\"\"</span>\n__Copyright__ <span class=\"token operator\">=</span> <span class=\"token string\">\"Copyright (c) 2018 Irony\"</span>\n__Version__ <span class=\"token operator\">=</span> <span class=\"token string\">\"Version 1.0\"</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">JumpSlider</span><span class=\"token punctuation\">(</span>QSlider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">mousePressEvent</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 获取上面的拉动块位置</span>\n        option <span class=\"token operator\">=</span> QStyleOptionSlider<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>initStyleOption<span class=\"token punctuation\">(</span>option<span class=\"token punctuation\">)</span>\n        rect <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>subControlRect<span class=\"token punctuation\">(</span>\n            QStyle<span class=\"token punctuation\">.</span>CC_Slider<span class=\"token punctuation\">,</span> option<span class=\"token punctuation\">,</span> QStyle<span class=\"token punctuation\">.</span>SC_SliderHandle<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> rect<span class=\"token punctuation\">.</span>contains<span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 如果鼠标点击的位置在滑块上则交给Qt自行处理</span>\n            <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>JumpSlider<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mousePressEvent<span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>orientation<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> Qt<span class=\"token punctuation\">.</span>Horizontal<span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 横向，要考虑invertedAppearance是否反向显示的问题</span>\n            self<span class=\"token punctuation\">.</span>setValue<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sliderValueFromPosition<span class=\"token punctuation\">(</span>\n                self<span class=\"token punctuation\">.</span>minimum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>maximum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                event<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>invertedAppearance<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">(</span>\n                <span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> event<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 纵向</span>\n            self<span class=\"token punctuation\">.</span>setValue<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sliderValueFromPosition<span class=\"token punctuation\">(</span>\n                self<span class=\"token punctuation\">.</span>minimum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>maximum<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> event<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>invertedAppearance<span class=\"token punctuation\">(</span>\n                <span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> event<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestWindow</span><span class=\"token punctuation\">(</span>QWidget<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>TestWindow<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>args<span class=\"token punctuation\">,</span> <span class=\"token operator\">**</span>kwargs<span class=\"token punctuation\">)</span>\n        layout <span class=\"token operator\">=</span> QFormLayout<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>label1 <span class=\"token operator\">=</span> QLabel<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span>\n        layout<span class=\"token punctuation\">.</span>addRow<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>label1<span class=\"token punctuation\">,</span> JumpSlider<span class=\"token punctuation\">(</span>\n            Qt<span class=\"token punctuation\">.</span>Horizontal<span class=\"token punctuation\">,</span> valueChanged<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> v<span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>label1<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 横向-反向显示</span>\n        self<span class=\"token punctuation\">.</span>label2 <span class=\"token operator\">=</span> QLabel<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span>\n        layout<span class=\"token punctuation\">.</span>addRow<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>label2<span class=\"token punctuation\">,</span> JumpSlider<span class=\"token punctuation\">(</span>\n            Qt<span class=\"token punctuation\">.</span>Horizontal<span class=\"token punctuation\">,</span> invertedAppearance<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n            valueChanged<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> v<span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>label2<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>label3 <span class=\"token operator\">=</span> QLabel<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span>\n        layout<span class=\"token punctuation\">.</span>addRow<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>label3<span class=\"token punctuation\">,</span> JumpSlider<span class=\"token punctuation\">(</span>\n            Qt<span class=\"token punctuation\">.</span>Vertical<span class=\"token punctuation\">,</span> minimumHeight<span class=\"token operator\">=</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> valueChanged<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> v<span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>label3<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># 纵向反向显示</span>\n        self<span class=\"token punctuation\">.</span>label4 <span class=\"token operator\">=</span> QLabel<span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span>\n        layout<span class=\"token punctuation\">.</span>addRow<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>label4<span class=\"token punctuation\">,</span> JumpSlider<span class=\"token punctuation\">(</span>\n            Qt<span class=\"token punctuation\">.</span>Vertical<span class=\"token punctuation\">,</span> invertedAppearance<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n            minimumHeight<span class=\"token operator\">=</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> valueChanged<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> v<span class=\"token punctuation\">:</span> self<span class=\"token punctuation\">.</span>label4<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">import</span> sys\n    <span class=\"token keyword\">import</span> cgitb\n    sys<span class=\"token punctuation\">.</span>excepthook <span class=\"token operator\">=</span> cgitb<span class=\"token punctuation\">.</span>enable<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtWidgets <span class=\"token keyword\">import</span> QApplication\n    app <span class=\"token operator\">=</span> QApplication<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span>\n    w <span class=\"token operator\">=</span> TestWindow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    w<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>exec_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"效果图\"><a class=\"markdownIt-Anchor\" href=\"#效果图\">#</a> 效果图</h2>\n<p><img src=\"/PyQt/QSlider/ScreenShot/ClickJumpSlider.gif\" alt=\"ClickJumpSlider\"></p>\n",
            "tags": [
                "PyQt",
                "滑动条"
            ]
        }
    ]
}